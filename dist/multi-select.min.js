/*! isteven-angular-multiselect 2017-04-17 */

angular.module("isteven-multi-select",["ng"]).directive("istevenMultiSelect",["$sce","$timeout","$templateCache","$http","$q",function(a,b,c,d,e){return{restrict:"AE",scope:{outputData:"=",initData:"=",initUrl:"@",filterUrl:"@",otherFilterData:"=",selectorId:"@",isDisabled:"=",onClear:"&",onClose:"&",onSearchChange:"&",onItemClick:"&",onOpen:"&",onReset:"&",onSelectAll:"&",onSelectNone:"&",translation:"="},templateUrl:"isteven-multi-select.htm",link:function(c,f,g){function h(){if(null!=c.initData&&c.initData.length>0){var a={};a.filterBy=c.initData,null!=c.selectorId&&""!==c.selectorId&&(c.selectorId.toUpperCase().indexOf("MERCHANT")>=0?a.DBObj="Merchant":c.selectorId.toUpperCase().indexOf("CUST")>=0?a.DBObj="Customer":c.selectorId.toUpperCase().indexOf("VENDOR")>=0?a.DBObj="Vendor":c.selectorId.toUpperCase().indexOf("ENGINEER")>=0?a.DBObj="User":c.selectorId.toUpperCase().indexOf("PURCHASEIN")>=0?a.DBObj="PurchaseIn":c.selectorId.toUpperCase().indexOf("PBMCATE")>=0&&(a.DBObj="PbmCategory")),a.need=g.buttonLabel,null!=c.initUrl&&""!==c.initUrl||(c.initUrl="/admin/multiselector/intitdata"),d.post(c.initUrl,a).success(function(a,b,d,e){if("success"===a.status){if(c.message=a.message,!a.data.filterRecord||0===a.data.filterRecord.length)return!1;a.data.filterRecord.forEach(function(a){var b,d,e,f,h=!1;if("id"!==g.buttonLabel)if("object"==typeof c.initData)for(b=0,e=c.initData.length;b<e;b++){if(c.outputData&&c.outputData.length>0)for(d=0,f=c.outputData.length;d<f;d++)if(c.outputData[d].id===c.initData[b]){h=!0;break}var i={id:c.initData[b],name:a[g.buttonLabel],ticked:!0};h||c.outputData.push(i)}else c.outputData.push({id:c.initData,name:a[g.buttonLabel],ticked:!0});else if("name"!==g.buttonLabel)if("object"==typeof c.initData)for(b=0,e=c.initData.length;b<e;b++)c.outputData.push({id:a[g.buttonLabel],name:c.initData[b],ticked:!0});else c.outputData.push({id:a[g.buttonLabel],name:c.initData,ticked:!0})}),c.refreshButton()}else console.error(a.message);c.busy=!1}).error(function(a,b,d,e){c.busy=!1,console.error(a)})}}function i(a){"undefined"!=typeof a&&a.length>0&&"undefined"!=typeof c.outputData&&c.outputData.length>0&&(a.forEach(function(a){c.outputData.forEach(function(b){a.id!==b.id&&a.name!==b.name||(a.ticked=!0)})}),c.refreshOutputData(),c.refreshButton())}function j(){!c.inputModel||c.inputModel.length<=0||c.otherFilterData&&c.otherFilterData!==c.bean.otherFilterData?(c.bean.fromIndex=0,c.bean.flag="init",angular.forEach(c.filteredModel,function(a,b){"undefined"!=typeof a&&a[g.disableProperty]!==!0&&"undefined"==typeof a[g.groupProperty]&&(a[c.tickProperty]=!1)}),c.bean.otherFilterData=c.otherFilterData,c.busy=!0,d.post(c.filterUrl,c.bean).success(function(a,b,d,e){"success"===a.status?(c.message=a.message,a.data.filterRecord&&a.data.filterRecord.length>0?(c.inputModel=a.data.filterRecord,c.filterInputModel=a.data.filterRecord,i(c.filterInputModel),c.refreshButton(),c.prepareIndex()):c.inputModel=[]):(console.error(a.message),c.message=a.message),c.busy=!1}).error(function(a,b,d,e){c.busy=!1,console.error(a)})):c.busy=!1}function k(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",c="",d=0;d<a;d++)c+=b.charAt(Math.floor(Math.random()*b.length));return c}c.backUp=[],c.varButtonLabel="",c.spacingProperty="",c.indexProperty="",c.orientationH=!1,c.orientationV=!0,c.filteredModel=[],c.inputLabel={labelFilter:""},c.tabIndex=0,c.lang={},c.connectService=!1,c.inputModel=[],c.helperStatus={all:!0,none:!0,reset:!0,filter:!0};var l,m=0,n=[],o=0,p="",q=[],r=0,s=null;c.clearClicked=function(a){c.inputLabel.labelFilter="",c.updateFilter(),c.select("clear",a)},c.$watch("otherFilterData",function(a,b){b!==a&&(c.refreshOutputData(),c.refreshButton(),c.filter())},!0),c.busy=!1,"undefined"==typeof c.bean&&(c.bean={}),"undefined"==typeof g.tickProperty&&(g.tickProperty="ticked"),"undefined"==typeof c.tickProperty&&(c.tickProperty="ticked"),c.init=function(){null==c.filterUrl||""===c.filterUrl||c.busy?c.busy=!1:h()},c.filter=function(){null==c.filterUrl||""===c.filterUrl||c.busy?c.busy=!1:j()},c.numberToArray=function(a){return new Array(a)},c.searchChanged=function(a){return!(c.inputLabel.labelFilter.length<r&&c.inputLabel.labelFilter.length>0)&&void c.updateFilter()},c.updateFilter=function(){c.filteredModel=[];var a=0;if("undefined"==typeof c.inputModel)return!1;for(a=c.inputModel.length-1;a>=0;a--)c.filteredModel.push(c.inputModel[a]);if(c.filteredModel.reverse(),null!=c.filterUrl&&""!==c.filterUrl&&null!=c.inputLabel.labelFilter&&""!==c.inputLabel.labelFilter&&!c.busy){c.bean={},c.bean.filterName=c.inputLabel.labelFilter,c.bean.flag="filter",c.bean.fromIndex=0,l=(new Date).getTime();var f=e.defer();c.busy&&(new Date).getTime-l>=5e3&&f.resolve("get reponse time out"),c.busy=!0,d.post(c.filterUrl,c.bean,{timeout:f.promise}).success(function(a,b,d,e){"success"===a.status?(c.message=a.message,c.filteredModel=a.data.filterRecord,a.data.filterRecord&&a.data.filterRecord.length>0&&(angular.forEach(a.data.filterRecord,function(a,b){for(var d=0;d<c.filterInputModel.length;d++)if(c.filterInputModel[d].id===a.id&&c.filterInputModel[d].name===a.name)return;c.filterInputModel.push({id:a.id,name:a.name})}),i(c.filteredModel),c.prepareIndex())):(console.error(a.message),c.message=a.message),c.busy=!1}).error(function(a,b,d,e){console.error(a),c.busy=!1})}b(function(){if(c.getFormElements(),c.inputLabel.labelFilter.length>r){var a=[];angular.forEach(c.filteredModel,function(b,d){if("undefined"!=typeof b&&"undefined"==typeof b[g.groupProperty]){var e=angular.copy(b),f=a.push(e);delete a[f-1][c.indexProperty],delete a[f-1][c.spacingProperty]}}),c.onSearchChange({data:{keyword:c.inputLabel.labelFilter,result:a}})}},0)},c.hasMore=!0,c.loadMore=function(){c.filteredModel.length>=20&&(c.bean={},c.bean.fromIndex=c.filteredModel.length,c.bean.flag="scoller",d.post(c.filterUrl,c.bean).success(function(a,b,d,e){if("success"===a.status){if(c.message=a.message,!a.data.filterRecord||0===a.data.filterRecord.length)return c.hasMore=!1,!1;a.data.filterRecord.length<20&&(c.hasMore=!1),angular.forEach(a.data.filterRecord,function(a,b){c.filterInputModel.push({id:a.id,name:a.name})}),c.filteredModel=c.filterInputModel,i(c.filteredModel),c.prepareIndex()}else console.error(a.message),c.message=a.message}).error(function(a,b,c,d){console.error(a)}))},c.getFormElements=function(){q=[];var a=[],b=[],d=[],e=[];c.helperStatus.all||c.helperStatus.none||c.helperStatus.reset?(a=f.children().children().next().children().children()[0].getElementsByTagName("button"),c.helperStatus.filter&&(b=f.children().children().next().children().children().next()[0].getElementsByTagName("input"),e=f.children().children().next().children().children().next()[0].getElementsByTagName("button"))):c.helperStatus.filter&&(b=f.children().children().next().children().children()[0].getElementsByTagName("input"),e=f.children().children().next().children().children()[0].getElementsByTagName("button")),d=c.helperStatus.all||c.helperStatus.none||c.helperStatus.reset||c.helperStatus.filter?f.children().children().next().children().next()[0].getElementsByTagName("input"):f.children().children().next()[0].getElementsByTagName("input");for(var g=0;g<a.length;g++)q.push(a[g]);for(var h=0;h<b.length;h++)q.push(b[h]);for(var i=0;i<e.length;i++)q.push(e[i]);for(var j=0;j<d.length;j++)q.push(d[j])},c.isGroupMarker=function(a,b){return"undefined"!=typeof a[g.groupProperty]&&a[g.groupProperty]===b},c.removeGroupEndMarker=function(a){return"undefined"==typeof a[g.groupProperty]||a[g.groupProperty]!==!1},c.syncItems=function(a,d,e){if(d.preventDefault(),d.stopPropagation(),"undefined"!=typeof g.disableProperty&&a[g.disableProperty]===!0)return!1;if("undefined"!=typeof g.isDisabled&&c.isDisabled===!0)return!1;if("undefined"!=typeof a[g.groupProperty]&&a[g.groupProperty]===!1)return!1;var f=c.filteredModel.indexOf(a);if("undefined"!=typeof a[g.groupProperty]&&a[g.groupProperty]===!0){if("undefined"!=typeof g.selectionMode&&"SINGLE"===g.selectionMode.toUpperCase())return!1;var h,i,j=0,k=c.filteredModel.length-1,l=[],n=0;for(h=f;h<c.filteredModel.length&&!(0===n&&h>f);h++)if("undefined"!=typeof c.filteredModel[h][g.groupProperty]&&c.filteredModel[h][g.groupProperty]===!0)0===l.length&&(j=h+1),n+=1;else if("undefined"!=typeof c.filteredModel[h][g.groupProperty]&&c.filteredModel[h][g.groupProperty]===!1){if(n-=1,l.length>0&&0===n){var p=!0;for(k=h,i=0;i<l.length;i++)if("undefined"!=typeof l[i][c.tickProperty]&&l[i][c.tickProperty]===!1){p=!1;break}var q;if(p===!0)for(i=j;i<=k;i++)"undefined"==typeof c.filteredModel[i][g.groupProperty]&&("undefined"==typeof g.disableProperty?(c.filteredModel[i][c.tickProperty]=!1,q=c.filteredModel[i][c.indexProperty],c.inputModel[q][c.tickProperty]=!1):c.filteredModel[i][g.disableProperty]!==!0&&(c.filteredModel[i][c.tickProperty]=!1,q=c.filteredModel[i][c.indexProperty],c.inputModel[q][c.tickProperty]=!1));else for(i=j;i<=k;i++)"undefined"==typeof c.filteredModel[i][g.groupProperty]&&("undefined"==typeof g.disableProperty?(c.filteredModel[i][c.tickProperty]=!0,q=c.filteredModel[i][c.indexProperty],c.inputModel[q][c.tickProperty]=!0):c.filteredModel[i][g.disableProperty]!==!0&&(c.filteredModel[i][c.tickProperty]=!0,q=c.filteredModel[i][c.indexProperty],c.inputModel[q][c.tickProperty]=!0))}}else l.push(c.filteredModel[h])}else{if("undefined"!=typeof g.selectionMode&&"SINGLE"===g.selectionMode.toUpperCase()){for(var r=0;r<c.filteredModel.length;r++)c.filteredModel[r][c.tickProperty]=!1;for(var t=0;t<c.inputModel.length;t++)c.inputModel[t][c.tickProperty]=!1;c.filteredModel[f][c.tickProperty]=!0}else c.filteredModel[f][c.tickProperty]=!c.filteredModel[f][c.tickProperty];angular.forEach(c.inputModel,function(b,d){b.name===a.name&&(b[c.tickProperty]=c.filteredModel[f][c.tickProperty])})}s=angular.copy(a),null!==s&&b(function(){delete s[c.indexProperty],delete s[c.spacingProperty],c.onItemClick({data:s}),s=null},0),c.refreshOutputData(),c.refreshButton(),m=c.tabIndex,c.tabIndex=e+o,d.target.focus(),c.removeFocusStyle(m),c.setFocusStyle(c.tabIndex),"undefined"!=typeof g.selectionMode&&"SINGLE"===g.selectionMode.toUpperCase()&&c.toggleCheckboxes(d)},c.removeSelected=function(a,b){if(b.preventDefault(),b.stopPropagation(),0!==c.outputData.length&&null!=c.outputData&&"undefined"!=typeof a&&""!==a){for(var d=0;d<c.filterInputModel.length;d++)if(c.filterInputModel[d].id===a&&c.filterInputModel[d][c.tickProperty]===!0){c.filterInputModel[d][c.tickProperty]=!1;break}for(var e=0;e<c.filteredModel.length;e++)if(c.filteredModel[e].id===a&&c.filteredModel[e][c.tickProperty]===!0){c.filteredModel[e][c.tickProperty]=!1;break}c.refreshOutputData(),0===c.outputData.length&&c.refreshButton()}},c.refreshOutputData=function(){c.outputData=[];var a=[],b={};c.filterInputModel=c.inputModel,"undefined"!=typeof g.outputProperties?(a=g.outputProperties.split(" "),angular.forEach(c.filterInputModel,function(d,e){if("undefined"!=typeof d&&"undefined"==typeof d[g.groupProperty]&&d[c.tickProperty]===!0){b={},angular.forEach(d,function(c,d){a.indexOf(d)>-1&&(b[d]=c)});var f=c.outputData.push(b);delete c.outputData[f-1][c.indexProperty],delete c.outputData[f-1][c.spacingProperty]}})):angular.forEach(c.filterInputModel,function(a,b){if("undefined"!=typeof a&&"undefined"==typeof a[g.groupProperty]&&a[c.tickProperty]===!0){var d=angular.copy(a),e=c.outputData.push(d);delete c.outputData[e-1][c.indexProperty],delete c.outputData[e-1][c.spacingProperty]}})},c.refreshButton=function(){c.varButtonLabel="";var b=0;if("undefined"==typeof c.outputData||0===c.outputData.length)c.varButtonLabel=c.lang.nothingSelected;else{var d=1;"undefined"!=typeof g.maxLabels&&""!==g.maxLabels&&(d=g.maxLabels),c.outputData.length>d?c.more=!0:c.more=!1,angular.forEach(c.outputData,function(a,e){"undefined"!=typeof a&&a[g.tickProperty]===!0&&(b<d&&(c.varButtonLabel+=(c.varButtonLabel.length>0?'</div>, <div class="buttonLabel text-left">':'<div class="buttonLabel  text-left">')+c.writeLabel(a,"buttonLabel")),b++)}),c.more===!0&&(d>0&&(c.varButtonLabel+=", ... "),c.varButtonLabel+="等"+c.outputData.length+"项&nbsp;&nbsp;&nbsp;")}c.varButtonLabel=a.trustAsHtml(c.varButtonLabel+'<span class="caret"></span>')},c.itemIsDisabled=function(a){return"undefined"!=typeof g.disableProperty&&a[g.disableProperty]===!0||c.isDisabled===!0},c.writeLabel=function(b,c){var d=g[c].split(" "),e="";return angular.forEach(d,function(a,c){b[a]&&(e+="&nbsp;"+a.split(".").reduce(function(a,b){return a[b]},b))}),"BUTTONLABEL"===c.toUpperCase()?e:a.trustAsHtml(e)},c.toggleCheckboxes=function(a){var d=f.children()[0];if(angular.element(document).off("click",c.externalClickListener),angular.element(document).off("keydown",c.keyboardListener),angular.element(p).hasClass("show"))angular.element(p).removeClass("show"),angular.element(d).removeClass("buttonClicked"),angular.element(document).off("click",c.externalClickListener),angular.element(document).off("keydown",c.keyboardListener),c.removeFocusStyle(c.tabIndex),"undefined"!=typeof q[c.tabIndex]&&q[c.tabIndex].blur(),b(function(){c.onClose()},0),f.children().children()[0].focus();else{c.inputLabel.labelFilter="",c.updateFilter(),n=[],o=0,angular.element(p).addClass("show"),angular.element(d).addClass("buttonClicked"),angular.element(document).on("click",c.externalClickListener),angular.element(document).on("keydown",c.keyboardListener),c.getFormElements(),c.tabIndex=0;var e=angular.element(f[0].querySelector(".helperContainer"))[0];if("undefined"!=typeof e){for(var g=0;g<e.getElementsByTagName("BUTTON").length;g++)n[g]=e.getElementsByTagName("BUTTON")[g];o=n.length+e.getElementsByTagName("INPUT").length}f[0].querySelector(".inputFilter")?(f[0].querySelector(".inputFilter").focus(),c.tabIndex=c.tabIndex+o-2,angular.element(f).children()[0].blur()):c.isDisabled||(c.tabIndex=c.tabIndex+o,c.inputModel.length>0&&(q[c.tabIndex].focus(),c.setFocusStyle(c.tabIndex),angular.element(f).children()[0].blur())),c.onOpen()}},c.externalClickListener=function(a){for(var d=f.find(a.target.tagName),e=0;e<d.length;e++)if(a.target==d[e])return;angular.element(p.previousSibling).removeClass("buttonClicked"),angular.element(p).removeClass("show"),angular.element(document).off("click",c.externalClickListener),angular.element(document).off("keydown",c.keyboardListener),b(function(){c.onClose()},0),f.children().children()[0].focus()},c.select=function(a,b){var d=n.indexOf(b.target);switch(c.tabIndex=d,a.toUpperCase()){case"ALL":angular.forEach(c.filteredModel,function(a,b){"undefined"!=typeof a&&a[g.disableProperty]!==!0&&"undefined"==typeof a[g.groupProperty]&&(a[c.tickProperty]=!0)}),angular.forEach(c.filterInputModel,function(a,b){"undefined"!=typeof a&&a[g.disableProperty]!==!0&&"undefined"==typeof a[g.groupProperty]&&(a[c.tickProperty]=!0)}),c.refreshOutputData(),c.refreshButton(),c.onSelectAll();break;case"NONE":angular.forEach(c.filteredModel,function(a,b){"undefined"!=typeof a&&a[g.disableProperty]!==!0&&"undefined"==typeof a[g.groupProperty]&&(a[c.tickProperty]=!1)}),angular.forEach(c.inputModel,function(a,b){"undefined"!=typeof a&&a[g.disableProperty]!==!0&&"undefined"==typeof a[g.groupProperty]&&(a[c.tickProperty]=!1)}),c.outputData=[],c.refreshButton(),c.onSelectNone();break;case"RESET":c.initData?(angular.forEach(c.filteredModel,function(a,b){"undefined"!=typeof a&&a[g.disableProperty]!==!0&&"undefined"==typeof a[g.groupProperty]&&(a[c.tickProperty]=!1)}),c.outputData=[],c.inputModel=[],c.refreshButton(),c.init(),c.filter()):(angular.forEach(c.filteredModel,function(a,b){if("undefined"==typeof a[g.groupProperty]&&"undefined"!=typeof a&&a[g.disableProperty]!==!0){a[c.indexProperty];a[c.tickProperty]=!1}}),angular.forEach(c.inputModel,function(a,b){"undefined"!=typeof a&&a[g.disableProperty]!==!0&&"undefined"==typeof a[g.groupProperty]&&(a[c.tickProperty]=!1)}),c.outputData=[],c.refreshButton()),c.onReset();break;case"CLEAR":c.tabIndex=c.tabIndex+1,c.onClear();break;case"FILTER":c.tabIndex=n.length-1}},c.prepareGrouping=function(){var a=0;angular.forEach(c.filteredModel,function(b,d){b[c.spacingProperty]=a,b[g.groupProperty]===!0?a+=2:b[g.groupProperty]===!1&&(a-=2)})},c.prepareIndex=function(){var a=0;angular.forEach(c.filteredModel,function(b,d){b[c.indexProperty]=a,a++})},c.keyboardListener=function(a){var b=a.keyCode?a.keyCode:a.which,d=!1;if(27===b)a.preventDefault(),a.stopPropagation(),c.toggleCheckboxes(a);else if(40===b||39===b||!a.shiftKey&&9==b)for(d=!0,m=c.tabIndex,c.tabIndex++,c.tabIndex>q.length-1&&(c.tabIndex=0,m=q.length-1);q[c.tabIndex].disabled===!0&&(c.tabIndex++,c.tabIndex>q.length-1&&(c.tabIndex=0),c.tabIndex!==m););else if(38===b||37===b||a.shiftKey&&9==b)for(d=!0,m=c.tabIndex,c.tabIndex--,c.tabIndex<0&&(c.tabIndex=q.length-1,m=0);q[c.tabIndex].disabled===!0&&(c.tabIndex--,c.tabIndex!==m);)c.tabIndex<0&&(c.tabIndex=q.length-1);if(d===!0){a.preventDefault(),q[c.tabIndex].focus();var e=document.activeElement;"CHECKBOX"===e.type.toUpperCase()?(c.setFocusStyle(c.tabIndex),c.removeFocusStyle(m)):(c.removeFocusStyle(m),c.removeFocusStyle(o),c.removeFocusStyle(q.length-1))}d=!1},c.setFocusStyle=function(a){angular.element(q[a]).parent().parent().parent().addClass("multiSelectFocus")},c.removeFocusStyle=function(a){angular.element(q[a]).parent().parent().parent().removeClass("multiSelectFocus")},c.groupProperty=g.groupProperty,c.tickProperty=g.tickProperty,c.directiveId=g.directiveId;var t=k(5);if(c.indexProperty="idx_"+t,c.spacingProperty="spc_"+t,"undefined"!=typeof g.orientation&&("HORIZONTAL"===g.orientation.toUpperCase()?(c.orientationH=!0,c.orientationV=!1):(c.orientationH=!1,c.orientationV=!0)),p=f.children().children().next()[0],"undefined"!=typeof g.maxHeight){var u=f.children().children().children()[0];angular.element(u).attr("style","height:"+g.maxHeight+"; overflow-y:scroll;")}for(var v in c.helperStatus)c.helperStatus.hasOwnProperty(v)&&"undefined"!=typeof g.helperElements&&g.helperElements.toUpperCase().indexOf(v.toUpperCase())===-1&&(c.helperStatus[v]=!1);"undefined"!=typeof g.selectionMode&&"SINGLE"===g.selectionMode.toUpperCase()&&(c.helperStatus.all=!1,c.helperStatus.none=!1),c.icon={},c.icon.selectAll="&#10003;",c.icon.selectNone="&times;",c.icon.reset="&#8630;",c.icon.tickMark="&#10003;","undefined"!=typeof g.translation?(c.lang.selectAll=a.trustAsHtml(c.icon.selectAll+"&nbsp;&nbsp;"+c.translation.selectAll),c.lang.selectNone=a.trustAsHtml(c.icon.selectNone+"&nbsp;&nbsp;"+c.translation.selectNone),c.lang.reset=a.trustAsHtml(c.icon.reset+"&nbsp;&nbsp;"+c.translation.reset),c.lang.search=c.translation.search,c.lang.nothingSelected=a.trustAsHtml(c.translation.nothingSelected)):(c.lang.selectAll=a.trustAsHtml(c.icon.selectAll+"&nbsp;&nbsp;Select All"),c.lang.selectNone=a.trustAsHtml(c.icon.selectNone+"&nbsp;&nbsp;Select None"),c.lang.reset=a.trustAsHtml(c.icon.reset+"&nbsp;&nbsp;Reset"),c.lang.search="Search...",c.lang.nothingSelected=""),c.icon.tickMark=a.trustAsHtml(c.icon.tickMark),"undefined"!=typeof g.MinSearchLength&&parseInt(g.MinSearchLength)>0&&(r=Math.floor(parseInt(g.MinSearchLength))),c.$watch("inputModel",function(a,b){b!==a&&(c.backUp=angular.copy(c.inputModel),c.updateFilter(),c.prepareGrouping(),c.prepareIndex())}),c.$watch("isDisabled",function(a){c.isDisabled=a}),c.$watch("initData",function(a,b){b!==a&&(c.backUp=angular.copy(c.inputModel),c.updateFilter(),c.prepareGrouping(),c.prepareIndex(),c.refreshOutputData(),c.refreshButton(),c.init())}),c.init();var w=function(a){c.$apply(function(){c.scrolled=!1})};angular.element(document).bind("touchstart",w);var x=function(a){c.$apply(function(){c.scrolled=!0})};angular.element(document).bind("touchmove",x),c.$on("$destroy",function(){angular.element(document).unbind("touchstart",w),angular.element(document).unbind("touchmove",x)})}}}]).run(["$templateCache",function(a){var b='<span class="multiSelect inlineBlock"><button class="form-control pull-left" id="{{directiveId}}" type="button"ng-click="toggleCheckboxes( $event ); refreshSelectedItems(); refreshButton(); prepareGrouping; prepareIndex(); filter();"ng-bind-html="varButtonLabel"ng-disabled="disable-button"></button><div class="checkboxLayer"><div class="helperContainer" ng-if="helperStatus.filter || helperStatus.all || helperStatus.none || helperStatus.reset "><div class="line" ng-if="helperStatus.all || helperStatus.none || helperStatus.reset "><button name="selectAll" type="button" class="helperButton"ng-disabled="isDisabled"ng-if="helperStatus.all"ng-click="select( \'all\', $event );"ng-bind-html="lang.selectAll"></button><button name="selectNone" type="button" class="helperButton"ng-disabled="isDisabled"ng-if="helperStatus.none"ng-click="select( \'none\', $event );"ng-bind-html="lang.selectNone"></button><button name="reset" type="button" class="helperButton reset"ng-disabled="isDisabled"ng-if="helperStatus.reset"ng-click="select( \'reset\', $event );"ng-bind-html="lang.reset"></button></div><div class="line" style="position:relative" ng-if="helperStatus.filter"><input name="inputFilter" placeholder="{{lang.search}}" type="text"ng-click="select( \'filter\', $event )" ng-model="inputLabel.labelFilter" ng-change="searchChanged()" class="inputFilter" ng-model-options="{debounce: 1500}"/><button type="button" class="clearButton" ng-click="clearClicked($event)" >×</button> </div> <div class="line" style="position:relative"><span ng-repeat="item in outputData"><button data-toggle="tooltip" data-placement="bottom" title="移除" ng-click="removeSelected(item.id, $event)" class="helperButton" ng-bind="\'x \'+item.name"></button></span></div></div> <div id="{{selectorId}}" class="checkBoxContainer" scroll-bottom="loadMore()" selector-id="selectorId"><div name="{{item.name}}" ng-repeat="item in filteredModel | filter:removeGroupEndMarker" class="multiSelectItem"ng-class="{selected: item[ tickProperty ], horizontal: orientationH, vertical: orientationV, multiSelectGroup:item[ groupProperty ], disabled:itemIsDisabled( item )}"ng-click="syncItems( item, $event, $index );" ng-mouseleave="removeFocusStyle( tabIndex );"> <div class="acol" ng-if="item[ spacingProperty ] > 0" ng-repeat="i in numberToArray( item[ spacingProperty ] ) track by $index"></div>  <div class="acol"><label><input class="checkbox focusable" type="checkbox" ng-disabled="itemIsDisabled( item )" ng-checked="item[ tickProperty ]" ng-click="syncItems( item, $event, $index )" value="{{item.id}}" /><span ng-class="{disabled:itemIsDisabled( item )}" ng-bind-html="writeLabel( item, \'itemLabel\' )"></span></label></div><span class="tickMark" ng-if="item[ groupProperty ] !== true && item[ tickProperty ] === true" ng-bind-html="icon.tickMark"></span></div><div class="multiSelectItem" ng-if="filteredModel.length >= 20 && hasMore">Load More……</div></div></div></span>';a.put("isteven-multi-select.htm",b)}]).directive("scrollBottom",["$timeout",function(a){return{scope:{scrollBottom:"&",selectorId:"="},restrict:"A",link:function(b,c,d){a(function(){var d=angular.element(document.getElementById(b.selectorId));d.bind("scroll",function(){d=d[0]||d,d.offsetHeight+d.scrollTop===d.scrollHeight&&a(function(){b.scrollBottom(),b.$apply()},500)}),c.on("$destroy",function(){c.unbind("scroll")})},500)}}}]);
//# sourceMappingURL=multi-select.map